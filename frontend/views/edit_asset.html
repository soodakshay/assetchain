
{% extends "./layout.html" %}

{% block css %}


<link rel="stylesheet" href="/jquery-ui-1.12.1.custom/jquery-ui.css"/>

<style>
    .md-radio label > .box {

        z-index: 0;

    }
    .md-radio label > .check { 
        z-index: 0;
    }
</style>
{% endblock%}


{% block content %}

<div class="page-content">
    <!-- BEGIN PAGE HEADER-->
    <h3 class="page-title">
        Edit Asset
    </h3>
    <div class="page-bar">
        <ul class="page-breadcrumb">
            <li>
                <i class="fa fa-home"></i>
                <a href="/assets">Edit Asset</a>
            </li>
        </ul>
    </div>
    <div class="row"><br/></div>
    <!-- END PAGE HEADER-->
    <div class="portlet-body form">
        <!-- BEGIN FORM-->
        <form method="post" action="/assets/update/{{assets.data.id}}" class="edit-asset horizontal-form" >
            <div class="form-body">
                <div class="row">
                    <div class="col-md-12">
                        <div class="form-group">
                            <label class="control-label">Select Category:</label>
                            <span class="star">*</span>
                            <select name="category_name" id="category_name" class="form-control">

                                <!--                                <option value="">Select One</option>-->
                                <option data-id="{{assets.data.asset.category.id}}" value="{{assets.data.asset.category.name}}" >{{assets.data.asset.category.name}}</option>
                                {% for category in categories %}
                                {% if assets.data.asset.category.id != category.Key %}
                                <option data-id="{{category.Key}}" value="{{category.Record.name}}"> {{category.Record.name}}</option>  
                                {% endif %}
                                {%endfor%}

                            </select>    
                        </div>
                    </div>
                </div>

                <input type="hidden" name="categoryid" id="categoryid" value="{{assets.data.asset.category.id}}">
                <!--                <input type="hidden" name="categoryid" id="categoryid" value="bbjag98b89c5nti11a70"  readonly>     -->

                <div class="row">
                    <div class="col-md-12">
                        <div class="form-group">
                            <label for= "name" class="control-label">Asset Name:</label>
                            <span class="star">*</span>
                            <input type="text" name="name" id="name" class="form-control" value="{{assets.data.asset.name}}" autocomplete="off" required>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for= "asset_number" class="control-label">Asset Number:</label>
                            <span class="star">*</span>
                            <input type="text" name= "asset_number" id="asset_number" class="form-control" value="{{assets.data.asset.asset_number}}" autocomplete="off" required>

                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="serial_number" class="control-label">Serial Number:</label>
                            <span class="star">*</span>
                            <input type="text" id="serial_number" name="serial_number" class="form-control" value="{{assets.data.asset.serial_number}}" autocomplete="off" required>

                        </div>
                    </div>
                </div>
                <!--                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="color" class="control-label">Device Color:</label>
                                            
                
                                                                        <div class="input-group color colorpicker-default" id="colorPlace" data-color="{{assets.data.asset.color}}" data-color-format="rgba">
                                            <input type="text" id="color" name="color" class="form-control" value="{{assets.data.asset.color}}" autocomplete="off" placeholder="Enter device color" >
                                                                            <span class="input-group-btn">
                                                                                <button class="btn default" type="button"><i style="background-color:{{assets.data.asset.color}}"></i>&nbsp;</button>
                                                                            </span>
                                        </div>
                
                                    </div>
                
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="quantity" class="control-label">Quantity:</label>
                                           
                                            <input type="text" name="quantity" id="quantity" class="form-control" value="{{assets.data.asset.quantity}}" autocomplete="off" >
                                        </div>
                                    </div>
                                </div>-->
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="purchase_date" class="control-label">Purchase Date:</label>

                            {% if assets.data.asset.purchase_date == "0001-01-01T00:00:00Z" %}
                            <input type="text"  id="purchase_date" name="purchase_date" class="form-control" value=""  readonly >
                            {% else %}
                            <input type="text"  id="purchase_date" name="purchase_date" class="form-control" value="{{assets.data.asset.purchase_date | date('d/m/Y')}}"  readonly >
                            {% endif %}

                            <!--                            <div class="input-group  date date-picker puplace" data-date-format="dd/mm/yyyy" data-date-end-date="0d">
                                                            <input type="text"  id="purchase_date" name="purchase_date" class="form-control"  value="{{assets.data.asset.purchase_date | date('d/m/Y')}}" readonly required>
                                                            <span class="input-group-btn">
                                                                <button class="btn default" type="button"><i class="fa fa-calendar"></i></button>
                                                            </span>
                                                        </div>-->
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="purchasing_amount" class="control-label">Purchasing amount:</label>

                            {% if assets.data.asset.purchasing_amount == 0 %}
                            <input type="text" id="purchasing_amount" name="purchasing_amount" class="form-control" value="" autocomplete="off" >
                            {% else %}
                            <input type="text" id="purchasing_amount" name="purchasing_amount" class="form-control" value="{{assets.data.asset.purchasing_amount}}" autocomplete="off" >
                            {% endif %}
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="warranty_upto" class="control-label">Warranty Upto:</label>

                            {% if assets.data.asset.warranty_upto == "0001-01-01T00:00:00Z" %}
                            <input type="text"   name="warranty_upto" id="warranty_upto" class="form-control" value=""  readonly >
                            {% else %}
                            <input type="text"   name="warranty_upto" id="warranty_upto" class="form-control" value="{{assets.data.asset.warranty_upto | date('d/m/Y')}}"  readonly >
                            {% endif %}
                            <!--                            <div class="input-group  date date-picker wplace" data-date-format="dd/mm/yyyy" >
                                                            <input type="text"   name="warranty_upto" id="warranty_upto" class="form-control" value="{{assets.data.asset.warranty_upto | date('d/m/Y')}}" readonly required>
                                                            <span class="input-group-btn ">
                                                                <button class="btn default" type="button"><i class="fa fa-calendar"></i></button>
                                                            </span>
                                                        </div>-->
                        </div>

                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="color" class="control-label">Device Color:</label>
                            <input type="text" id="color" name="color" class="form-control" value="{{assets.data.asset.color}}" autocomplete="off" placeholder="Enter device color" >                          
                        </div>

                    </div>

                </div>
                <!--                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="status" class="control-label">Status:</label>
                                            <span class="star">*</span>
                                           
                                        </div>
                                    </div>
                                </div>-->
                <div class="row">

                    <div class="col-md-6">
                        <div class="form-group form-md-radios">
                            <label>Status</label>
                            <input type="hidden"  id="fetch_status" value="{{assets.data.asset.status}}" >
                            <div class="md-radio-inline">
                                <div class="md-radio">
                                    <input type="radio" id="active" name="status" class="md-radiobtn" value="1" >
                                    <label for="active">
                                        <span></span>
                                        <span class="check"></span>
                                        <span class="box"></span>
                                        Active </label>
                                </div>
                                <div class="md-radio">
                                    <input type="radio" id="inactive" name="status" class="md-radiobtn" value="0" >
                                    <label for="inactive">
                                        <span></span>
                                        <span class="check"></span>
                                        <span class="box"></span>
                                        Inactive </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="description" class="control-label">Additional Description:</label>

                            <textarea class="form-control" name="description" id="description" rows="3"  >{{assets.data.asset.description}}</textarea>

                        </div>
                    </div>
                </div>

                <!--                <div class="row">
                                    <div class="col-md-6">
                
                                        <div class="form-group">
                                            <label for="bill_reciept" class="control-label">Attach Bill:</label>
                                            <span class="star">*</span>
                                            <span class="btn green fileinput-button">
                                                <i class="fa fa-plus"></i>
                                                <span>
                                                    Upload PDF </span>
                                                <input type="file" id="bill" name="bill_reciept" required>
                                            </span>  
                                        </div>
                                    </div>
                                </div >-->
                <!--                        <div class="col-md-3">
                                            <div class="display_bill" ></div>
                                        </div>-->

                <div class="form-actions right">
                    <a  href="/assets" class="btn default">Cancel</a>
                    <button type="submit"   class="btn blue"><i class="fa fa-check"></i> Update</button>
                </div>
            </div>

        </form>

    </div>


    {% endblock %}


    <!--
    Javascript Block Begins
    -->
    {% block js %}
    <script src="../../assets/global/plugins/jquery-ui/jquery-ui.min.js" type="text/javascript"></script>
    <script src="../../assets/global/plugins/bootbox/bootbox.min.js" type="text/javascript"></script>
    <script>
//********** to show image
//add image using function
//    function readURL(input) {
//
//        if (input.files && input.files[0]) {
//            var reader = new FileReader();
//
//            reader.onload = function (e) {
//
//                $('.display_bill').html('<img src="' + e.target.result + '"height="' + 100 + '"width="' + 100 + '"/>');
//
//            };
//
//            reader.readAsDataURL(input.files[0]);
//        }
//    }
//    //display image
//    $("#bill").change(function () {
//        readURL(this);
//    });

    </script>



    <script type="text/javascript">
        $(document).ready(function () {


            //set date picker
            $("#purchase_date").datepicker({
                dateFormat: 'dd/mm/yy',
                changeMonth: true,
                changeYear: true,
                maxDate: '0',

                onSelect: function (date) {
                    //Set Minimum Date of EndDatePicker After Selected Date of StartDatePicker
                    $("#warranty_upto").datepicker("option", "minDate", date);
                    $("#purchase_date").removeClass("error");
                    $("#purchase_date-error").empty();


                }
            });
            $("#warranty_upto").datepicker({
                beforeShow: function () {
                    let min = $("#purchase_date").val();
                    $("#warranty_upto").datepicker("option", "minDate", min);
                },
                dateFormat: 'dd/mm/yy',
                changeMonth: true,
                //beforeShowDay: myFunction,
                onSelect: function (date) {
                    $("#warranty_upto").removeClass("error");
                    $("#warranty_upto-error").empty();
                }
            });

//    function myFunction(input, inst)
//    {
//        var purchase_date = $("#purchase_date").val();
//           $("#warranty_upto").datepicker("option", "minDate", purchase_date);
//
//    }



            //validate the form

            $(".edit-asset").validate({

                rules: {
                    category_name: {
                        required: true
                    },
                    status: {
                        required: true,

                    },
                    name: {
                        required: true,
                        minlength: 3,
                        maxlength: 32
                    },
                    asset_number: {
                        required: true,
                        maxlength: 32,
                        digits: true
                    },
                    serial_number: {
                        required: true,
                        maxlength: 32
                    }
//            quantity: {
//                required: true,
//                maxlength: 15
//
//            }
//            ,
//             purchasing_amount: {
//                required: true,
//                maxlength: 25,
//
//            }
//            color: {
//                required: true,
//                maxlength: 15
//            },

//            purchase_date: {
//                required: true
//
//            },

//            warranty_upto: {
//                required: true
//
//            },
//            description: {
//                required: true,
//                minlength: 5,
//                maxlength: 255
//            }

                },
                errorPlacement: function (error, element) {
//                    if (element.attr("name") == "warranty_upto")
//                        error.insertAfter(".wplace");
//                    else if (element.attr("name") == "purchase_date")
//                        error.insertAfter(".puplace");
////                    else if (element.attr("name") == "color")
////                        error.insertAfter("#colorPlace");
//                    else
                    error.insertAfter(element);
                },
                submitHandler: function (form, event) {
                    event.preventDefault();
                    bootbox.confirm({
                        message: "Are you sure you want to update the asset?",
                        buttons: {
                            confirm: {
                                label: 'Yes',
                                className: 'btn-success'
                            },
                            cancel: {
                                label: 'No',
                                className: 'btn-danger'
                            }
                        },
                        callback: function (result) {
                            console.log('This was logged in the callback: ' + result);
                            if (result) {
                                form.submit();
                            }
                        }
                    });
                }
            });

            //**********get category id and set in hidden field********

            $('select').change(function () {
                //alert($(this).children('option:selected').data('id'));
                var categoryid = $(this).children('option:selected').data('id');
                $("#categoryid").val(categoryid);

            });

//reset form feilds
//        $(".reset").click(function () {
//            $(this).closest('form').find("input[type=text], textarea").val("");
//        });

            //fetch status and then dynamically checked it
            var status = $('#fetch_status').val();
            if (status == 1) {
                $('#active').attr('checked', true);
            } else {
                $('#inactive').attr('checked', true);
            }


//disable input text input from user  
            $('#purchase_date').keydown(function () {
                return false;
            });
            $('#warranty_upto').keydown(function () {
                return false;
            });

//     if($("#category_name").val()===""){
//                    alert("first add the category ");
//                }
            //  ComponentsPickers.init();
            // UIAlertDialogApi.init();

        });
    </script>



    {% endblock %}

    <!--
    Javascript Block Ends
    -->

